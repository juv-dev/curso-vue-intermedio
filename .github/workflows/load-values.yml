name: Load Values

on:
  push:
    branches: [main, develop]
    paths:
      - '.env.*'
      - '**/.env.*'
  workflow_dispatch:

jobs:
  load-values:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Load environment values
        run: |
          if [ "${{ github.ref_name }}" = "main" ]; then
            ENV_FILE=".env.production"
          else
            ENV_FILE=".env.development"
          fi
          
          if [ -f "$ENV_FILE" ]; then
            echo "Loading values from $ENV_FILE"
            # Upload as artifact
            mkdir -p config
            cp "$ENV_FILE" config/.env
          else
            echo "Warning: $ENV_FILE not found, creating empty .env"
            mkdir -p config
            touch config/.env
          fi
          
      - name: Upload environment file
        uses: actions/upload-artifact@v4
        with:
          name: env-file
          path: config/.env
          retention-days: 1